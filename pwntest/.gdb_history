si
nextc
i b
nextjm
ni
x/gx 0x7fffffffe290
x/gx $rsp + 0x40
r
i b
x/gx 0x7fffffffe290
q
fin
nextc
x/x 0x7fffffffe328
x/gx 0x7fffffffe328
q
b main
r
x/gx 0x7fffffffe290 
x/gx 0x7fffffffe290 
nextc
si
nextc
nextjm
ni
r
nextc
set $rsi = 0
si
nextc
nextjm
ni
x/gx 0x7fffffffe290
x/gx 0x00007ffff7b97e9f
x/s 0x00007ffff7b97e9f
r
x/x 0x00007ffff7b97e9f
x/s 0x00007ffff7b97e9f
x/gx 0x00007ffff7b97e9f
x/s 0x00007ffff7b97e9f
vmmap
x/s 0x00007ffff7b97e9f
q
x/gx 0x7fffffffe328
fin
nextc
nextjm
ni
x/gx 0x7fffffffe328
x/gx $rsp + 0x40
ni
set $rip = 0x7ffff782f2fb
ni
x/gx $rsp + 0x40
vmmap
q
r <<<$(python2 exp.py)
bt
b main
r <<<$(python2 exp.py)
q
q
b main
r
rop 'pop rdi ; ret'
rop --grep 'pop rdi ; ret'
q
fin
ni
c
c
q
q
q
c
q
q
c
q
c
q
b main
r
p buf
p &buf
vmmap
p/x 0x7ffff7dd0880 - 0x7ffff79e4000
p system
p/x 0x7ffff7a33440 - 0x7ffff79e4000
search /bin/sh
p/x 0x7ffff7b97e9a - 0x7ffff79e4000
rop --grep 'pop rdi ; ret'
p/x 0x7ffff7dd0880 - 0x7ffff79e4000
p/x 0x7ffff79e4000 - 0x3ec880
p/x 0x7ffff7dd0880 - 0x3ec880
q
b main
r
nextc
p/x 0x7fffffffe3f3 - $rsp
p/d 0x7fffffffe3f3 - $rsp
p/d $rsp + 1
p/d $rsp - 0x7fffffffe3f3
p/d 0x7fffffffe3f3 - $rsp
i r rsp
p/d 0x7fffffffe3f3 - 0x7fffffffe3f0
p/x 0x7fffffffe3f3 - 0x7fffffffe3f0
p/x 0x7fffffffe3f3 - 0x7fffffffe3f0
i r rsp
ctx
r
i r rsp
nextc 3
r
i r rsp
nextc
p/x 0x7fffffffe400 0x7fffffffe3f3
p/x 0x7fffffffe400 - 0x7fffffffe3f3
i b
r
b *(main)
i b
d bre 1
r
i r rsp
nextc
p/x 0x7fffffffe408 - 0x7fffffffe3f3
q
r
b main
r
ni
si
i r rsp
nextc
p/x 0x7fffffffe3f8 - 0x7fffffffe3e3
x/20x 0x7fffffffe3e3
in
ni
x/20x 0x7fffffffe3e3
ni
r
ni
si
nextc
b
ni
ni
r
c
ni
ni
ni
r <<< $(echo aaaaaaaaaaaaaaaaaaaaaaaaaaaaa)
c
c
r
ni
si
i r rsp
nextc
p/x 0x7fffffffe3f8 - 0x7fffffffe3e3
python print 'a'
python print('a')
python print('a'*0x15)
python print('a'*(0x15+8))
ni
r
ni
si
nextc
ni
q
bt
q
q
b vuln
r
nextc
ni
ni
r
nextc
ni
ni
rop --grep 'pop rdi ; ret'
q
rop --grep 'pop rdi ; ret'
r
q
rop --grep 'pop rdi ; ret'
r
rop --grep 'pop rdi ; ret'
rop --grep 'pop rdi ; ret'
rop --grep 'pop rdi ; ret' --
q
b *(main)
r
i r rsp
nextc
p/x 0x7fffffffe408 - 0x7fffffffe3fb
rop --grep 'pop rdi ; ret'
q
q
q
bt
rop --grep 'pop rdi ; ret'
r
aew
rop --grep 'pop rdi ; ret'
b main
r
rop --grep 'pop rdi ; ret'
q
rop --grep 'pop rdi ; ret'
q
q
b main
r
rop --grep 'pop rdi ; ret'
q
q
b main
r
ni
si
i r rsp
p/x 0x7fffffffe3f8 - 
nextc
p/x 0x7fffffffe3f8 -  0x7fffffffe3e3
rop --grep 'pop rid ; ret'
rop --grep 'pop rdi ; ret'
rop --grep 'pop rdi ; ret'
q
q
b main
r
ni
si
i r rsp
nextc
p/x 0x7fffffffe3f8 - 0x7fffffffe3b0
r
c
r
vmmap
0x7ffff7844e80
p system
p printf
x/d 0x7ffff7844e80 - 0x7ffff77e0000
p/x 0x7ffff7844e80 - 0x7ffff77e0000
p/x 0x7ffff782f440 - 0x7ffff77e0000
search "/bin/sh"
p/x 0x7ffff7993e9a - 0x7ffff77e0000
q
q
